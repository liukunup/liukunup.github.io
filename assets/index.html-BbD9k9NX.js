import{_ as i,c as e,d as a,o as n}from"./app-BxVB_gzI.js";const t={};function l(h,s){return n(),e("div",null,[...s[0]||(s[0]=[a(`<p>wrk 是一个现代 HTTP 基准测试工具，当在单个多核 CPU 上运行时，能够产生显著的负载。它结合了多线程设计和可扩展的事件通知系统，如 epoll 和 kqueue。</p><p>虽然 wrk 本身是一个简单的 C 程序，但它包含了一个强大的嵌入式 LuaJIT 脚本接口。这不仅可以用来生成复杂的 HTTP 请求工作负载，还可以对响应处理和自定义报告进行编程。</p><p>Github: <a href="https://github.com/wg/wrk/" target="_blank" rel="noopener noreferrer">https://github.com/wg/wrk/</a></p><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><h3 id="macos" tabindex="-1"><a class="header-anchor" href="#macos"><span>macOS</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">brew</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wrk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="linux-ubuntu-debian" tabindex="-1"><a class="header-anchor" href="#linux-ubuntu-debian"><span>Linux (Ubuntu/Debian)</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt-get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wrk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="源码编译" tabindex="-1"><a class="header-anchor" href="#源码编译"><span>源码编译</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> clone</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://github.com/wg/wrk.git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wrk</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wrk</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法"><span>基本用法</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">wrk</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c400</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d30s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://127.0.0.1:8080/index.html</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这个命令运行一个基准测试，持续 30 秒，使用 12 个线程，并保持 400 个 HTTP 连接打开。</p><h3 id="参数说明" tabindex="-1"><a class="header-anchor" href="#参数说明"><span>参数说明</span></a></h3><ul><li><code>-c, --connections</code>：保持打开的 HTTP 连接总数，每个线程处理 <code>N = connections/threads</code> 个连接。</li><li><code>-d, --duration</code>：测试持续时间，例如 2s, 2m, 2h。</li><li><code>-t, --threads</code>：使用的总线程数。</li><li><code>-s, --script</code>：LuaJIT 脚本，用于自定义请求生成和响应处理。</li><li><code>-H, --header</code>：添加到请求的 HTTP 头，例如 <code>&quot;User-Agent: wrk&quot;</code>。</li><li><code>--latency</code>：打印详细的延迟统计信息。</li><li><code>--timeout</code>：如果在此时间内未收到响应，则记录为超时。</li></ul><h3 id="输出示例" tabindex="-1"><a class="header-anchor" href="#输出示例"><span>输出示例</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-text"><span class="line"><span>Running 30s test @ http://127.0.0.1:8080/index.html</span></span>
<span class="line"><span>  12 threads and 400 connections</span></span>
<span class="line"><span>  Thread Stats   Avg      Stdev     Max   +/- Stdev</span></span>
<span class="line"><span>    Latency   635.91us    0.89ms  12.92ms   93.69%</span></span>
<span class="line"><span>    Req/Sec    56.20k     8.07k   62.00k    86.54%</span></span>
<span class="line"><span>  22464657 requests in 30.00s, 17.76GB read</span></span>
<span class="line"><span>Requests/sec: 748868.53</span></span>
<span class="line"><span>Transfer/sec:    606.33MB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="lua-脚本" tabindex="-1"><a class="header-anchor" href="#lua-脚本"><span>Lua 脚本</span></a></h2><p>wrk 支持使用 Lua 脚本进行更复杂的测试场景，例如 POST 请求、自定义 Header、认证等。</p><p>详情参考：<a href="https://github.com/wg/wrk/blob/master/SCRIPTING" target="_blank" rel="noopener noreferrer">Scripting</a></p>`,20)])])}const r=i(t,[["render",l]]),c=JSON.parse('{"path":"/blog/jns8e7i0/","title":"wrk","lang":"zh-CN","frontmatter":{"title":"wrk","createTime":"2026/01/13 17:04:55","permalink":"/blog/jns8e7i0/"},"readingTime":{"minutes":1.36,"words":408},"git":{"createdTime":1768295289000,"updatedTime":1768295289000,"contributors":[{"name":"LiuKun","username":"LiuKun","email":"liukunup@163.com","commits":1,"avatar":"https://avatars.githubusercontent.com/LiuKun?v=4","url":"https://github.com/LiuKun"}]},"filePathRelative":"blog/wrk.md","headers":[],"categoryList":[]}');export{r as comp,c as data};
